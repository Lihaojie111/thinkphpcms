<extend name="Include:mother" /><block name="content"><div class="g_tab">	<div class="title">电话设置</div></div>			<div class="g_operation">				<div class="lft">					<!--                    <form action="" method="get" name="form1">                        标题搜索：                        <input class="text" name="title" type="text" value="{$Think.get.title}"/>                        &nbsp;                        <input class="submit" type="submit" value="搜索" />                    </form>                    -->				</div>				<div class="rgt">					<div class="btn_group">						<dl>							<dd><a href="{:U('ToolPhone/add')}">新增客服</a></dd>						</dl>						<div class="clear"></div>					</div>				</div>				<div class="clear"></div>			</div>			<table class="g_list">				<tr>					<th width="40">ID</th>					<th>客服名称</th>					<th>客服链接</th>					<th>备注</th>					<th>排序</th>					<th>状态</th>					<th>操作</th>				</tr>				<volist name='list' id='vo'>					<tr class="tr_{$vo.id}">						<td>{$vo.id}</td>						<td>{$vo.name}</td>						<td>{$vo.url}</td>						<td>{$vo.remark}</td>						<td>							<input class="text" type="text" name="sort" value="{$vo.sort}" old-sort="{$vo.sort}" data-id="{$vo.id}" style="width:40px;" />							<a href="#" onclick="return update_sort_one({$vo.id},this)">更新</a>						</td>						<td>							<select name="is_show" onchange="return set_is_show({$vo.id},this);">								<switch name="vo.is_show">									<case value="0">										<option value="1">开启</option>										<option value="0" selected="selected">关闭</option>									</case>									<case value="1">										<option value="1" selected="selected">开启</option>										<option value="0">关闭</option>									</case>								</switch>							</select>						</td>						<td>							<a href="{:U('ToolPhone/edit',array('cate_id'=>$vo['pid'],'id'=>$vo['id'],'jump_url'=>array_encode($_GET)))}">编辑</a>&nbsp;&nbsp;&nbsp;							<a href="#" onclick="return del({$vo.id})">删除</a>						</td>					</tr>				</volist>			</table>			<div class="g_btns">				<a class="btn" href="#" onclick="return update_sort();">更新排序</a>			</div><script>	//ajax删除单页	function del($id){		$.confirm({text:'确认删除？',title:'删除单页'},function(){			$.ajax({				type:"post",				url: "{:U('ToolPhone/ajax_del')}",				data: {id:$id},				success: function(data){					if(data)					{						$.ktext({text:'删除成功！',delay:1200},function(){							$(".tr_"+$id).remove();						});					}else					{						$.ktext({text:'删除失败！',delay:1200});					}				}			});		});		return false;	}	//更新单条排序	function update_sort_one($id,obj){		var old_sort = $(obj).prev().attr('old-sort');		var now_sort = $(obj).prev().val();		if(old_sort == now_sort){			$.ktext({text:"请先调整排序值！",delay:1200});			return false;		}else{			$.ajax({				type:"post",				url:"{:U('ToolPhone/ajax_setsort')}",				data:{id:$id,sort:now_sort},				success:function(data){					if(data['status']){						$.ktext({text:"更新成功！",delay:1200},function(){							window.location = window.location;						});					}				}			});		}		return false;	}	function update_sort(){		$last_id = $("input[name=sort]").last().attr('data-id');		$("input[name=sort]").each(function(){			var $id = $(this).attr('data-id'),$sort = $(this).val(),$old_sort = $(this).attr('old_sort');			if($old_sort!=$sort){				$.ajax({					type:"post",					url:"{:U('ToolPhone/ajax_setsort')}",					data:{id:$id,sort:$sort},					success:function(data){						if(data['status'] && $id == $last_id){							$.ktext({text:"更新成功！",delay:1200},function(){								window.location = window.location;							});						}					}				});			}		});		return false;	}	//ajax取消置顶活动	function set_is_show($id,obj){		$.ajax({			type:"post",			url: "{:U('ToolPhone/ajax_set_is_show')}",			data: {id:$id,val:$(obj).val()},			success: function(data){				if(data)				{					$.ktext({text:'状态设置成功！',delay:1200},function(){					});				}else{					$.ktext({text:'状态设置失败！',delay:1200});				}			}		});		return false;	}</script></block>