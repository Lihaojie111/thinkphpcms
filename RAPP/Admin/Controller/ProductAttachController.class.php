<?phpnamespace Admin\Controller;use Admin\Controller;class ProductAttachController extends RootController{	/**	 * 附加优惠列表	 */	public function lists(){		$list = M('ProductAttach')->order('sort,id')->select();		$this->assign('lists',$list);		$this->display();	}	/**	 * 添加附加优惠	 */	public function add(){		if(IS_POST){			$res = D('ProductAttach')->add_item($_POST);			if(!$res['status']){				$this->error($res['error']);			}else{				$this->success('恭喜你，发布成功！','ProductAttach/lists');			}		}else{			$this->display();		}	}	/**	 * 编辑附加优惠	 */	public function edit(){		if(IS_POST){			$res = D('ProductAttach')->save_item($_POST);			if(!$res['status']){				$this->error($res['error']);			}else{				$this->success('恭喜你，编辑成功！','ProductAttach/lists');			}		}else{			$page = M('ProductAttach')->find($_GET['id']);			$this->assign('page',$page);			$this->display();		}	}	/**	 *ajax删除特惠	 *@create 2014-12-19	 *@author zjf	 */	public function ajax_del(){		$res = D('ProductAttach')->del_item(array('id'=>$_POST['id']));		if($res){			$res1 = M('Product')->where(array('attach'=>$_POST['id']))->setField('attach',null);		}		if(false !== $res1){			$this->ajaxReturn($res);		}else{			$this->ajaxReturn(false);		}	}	/**	 *ajax设置排序	 *@create 2014-12-16	 *@author zjf	 */	public function ajax_setsort(){		$data['id'] = $_POST['id'];		$data['sort'] = $_POST['sort'];		$res = D('ProductAttach')->save_item($data);		$this->ajaxReturn($res);	}}